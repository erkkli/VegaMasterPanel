
@model SefimV2.ViewModels.SubeSettings.SubeSettingsViewModel


@{
    /**/

    #region base URL bilgisi set ediliyor
    var urlHelper = new UrlHelper(Html.ViewContext.RequestContext);
    string baseUrl = urlHelper.Content("~");
    #endregion

    var uygulamaTipi = ViewBag.UygulamaTipi;

    #region View tanımları
    ViewBag.Title = "";
    string PagecontentClass = "";
    string CloseButton = "";
    string CloseButtonHeader = "";
    string CancelButton = "";

    string Controller = ViewBag.Controller;
    Dictionary<string, string> PageNavi = ViewBag.PageNavi;

    if (ViewBag.Page == "modal")
    {
        Layout = "~/Views/Shared/_Layout_Modal.cshtml";
        PagecontentClass = "modal-page-margintop";
        CloseButton = "<button type='button' data-dismiss='modal' class='btn btn-danger' id='CloseModal'> Vazgeç </button>";
        CloseButtonHeader = "<button type='button' class='close' data-dismiss='modal' aria-hidden='true'></button>";
    }
    else
    {
        if (uygulamaTipi == "sp")
        {
            Layout = "~/Views/Shared/_LayoutPageSPos.cshtml";
            @*<script src="~/Scripts/jquery.unobtrusive-ajax.min.js"></script>*@
        }
        else
        {
            Layout = "~/Views/Shared/_LayoutPage.cshtml";
            PagecontentClass = "page-content";
            //CancelButton = "<a href='" + Url.Action("Index", Controller) + "' class='btn btn-danger'> Vazgeç </a>";
            CancelButton = "<a href='" + Url.Action("Index", "SubeSettings/List") + "' class='btn btn-danger'> Vazgeç </a>";
            <link href="/Assets/css/bootstrap.css" rel="stylesheet" />
            <link href="/Assets/css/custom.css" rel="stylesheet" />

            <link href="/Assets/plugins/fUpload/Uploader-style.css" rel="stylesheet" />
        }
    }
    #endregion
}
@*<script src="@(baseUrl)Scripts/MicrosoftAjax.js"></script>*@

<script src="@(baseUrl)Content/ajax/alerts.js" type="text/javascript"></script>
<link href="~/Content/ContentSefPanel/css/costomfieldset/customfielset.css" rel="stylesheet" />

@*<div class="m-content">*@
<div class="row">
    <div class="col-lg-12">
        <div id="notification"></div>
    </div>
</div>
@*<div class="row">*@
<div class="col-lg-12">
    <!--begin::Portlet-->
    <div class="m-portlet">
        <fieldset class="well  the-fieldset ">
            <legend class="the-legend">@ViewBag.PageTitle @ViewBag.ActionTitle </legend>
            <!--begin::Form-->
            @using (Ajax.BeginForm("Ekle", "SubeSettings", FormMethod.Post, new AjaxOptions { OnSuccess = "OnSuccess", OnBegin = "OnBegin", OnComplete = "OnComplete" }, htmlAttributes: new { @class = "m-form", @id = "SubeSettingsEkle" }))
            {
                @Html.AntiForgeryToken()
                @Html.HiddenFor(m => m.ID)

        <div class="m-portlet__body">
            <div class="form-group m-form__group row">
                <label class="col-form-label col-md-3 col-sm-3 col-xs-12">Uygulama Tanımı <span class="required"> * </span></label>
                <div class="col-lg-9 col-md-12 col-sm-12">
                    @Html.DropDownListFor(m => m.AppDbType, new List<SelectListItem>() {
                                  new SelectListItem() {Text = "Uygulama Seçiniz",Value ="0" },
                                  new SelectListItem() {Text = "Şefim Yeni",Value ="1" },
                                  new SelectListItem() {Text = "Şefim Eski",Value ="2" },
                                  new SelectListItem() {Text = "Faster",Value ="3" },
                                  new SelectListItem() {Text = "NPos",Value ="4" },
                                  new SelectListItem() {Text = "V-Pos",Value ="5" },
                           }, new { @id = "AppDbTypeid", @class = "form-control m-select2" })
                </div>
            </div>
            <div class="form-group m-form__group row fasterPosShowHide">
                <label class="col-form-label col-md-3 col-sm-3 col-xs-12">Online / Ofline <span class="required"> * </span></label>
                <div class="col-lg-9 col-md-12 col-sm-12">
                    @Html.DropDownListFor(m => m.AppDbTypeStatus, new List<SelectListItem>() {
                                  new SelectListItem() {Text = "Durum Seçiniz",Value ="0" },
                                  new SelectListItem() {Text = "Online",Value ="True" },
                                  new SelectListItem() {Text = "Ofline",Value ="False" },
                           }, new { @id = "AppDbTypeStatusid", @class = "form-control m-select2" })
                </div>
            </div>
            <div class="form-group m-form__group row">
                <label class="col-form-label col-md-3 col-sm-3 col-xs-12">Şube Adı<span class="required"> * </span></label>
                <div class="col-lg-9 col-md-12 col-sm-12">
                    @Html.TextBoxFor(m => m.SubeName, htmlAttributes: new { @id = "SabstationName", @maxlength = "255", @class = "form-control", @placeholder = "Şube Adı" })
                </div>
            </div>
            <div class="form-group m-form__group row">
                <label class="col-form-label col-md-3 col-sm-3 col-xs-12"> Şube İp<span class="required"> * </span></label>
                <div class="col-lg-9 col-md-12 col-sm-12">
                    @Html.TextBoxFor(m => m.SubeIP, htmlAttributes: new { @id = "SabsatationIp", @maxlength = "255", @class = "form-control", @placeholder = "Şube İp" })
                </div>
            </div>
            <div class="form-group m-form__group row">
                <label class="col-form-label col-md-3 col-sm-3 col-xs-12">  Sql Adı <span class="required"> * </span></label>
                <div class="col-lg-9 col-md-12 col-sm-12">
                    @Html.TextBoxFor(m => m.SqlName, htmlAttributes: new { @id = "SqlName", @maxlength = "255", @class = "form-control", @placeholder = "Sql Adı" })
                </div>
            </div>
            <div class="form-group m-form__group row">
                <label class="col-form-label col-md-3 col-sm-3 col-xs-12">Sql Şifre <span class="required"> * </span></label>
                <div class="col-lg-9 col-md-12 col-sm-12">

                    @Html.TextBoxFor(m => m.SqlPassword, htmlAttributes: new { @id = "SqlPassword", @maxlength = "255", @class = "form-control", @placeholder = "Sql Şifre" })
                </div>
            </div>
            <div class="form-group m-form__group row">
                <label class="col-form-label col-md-3 col-sm-3 col-xs-12"> DB Adı <span class="required"> * </span></label>
                <div class="col-lg-9 col-md-12 col-sm-12">
                    @Html.TextBoxFor(m => m.DBName, htmlAttributes: new { @id = "DBName", @maxlength = "255", @class = "form-control", @placeholder = "Database Adı" })
                </div>
            </div>
            @*<div class="form-group m-form__group row">
                 <label class="col-form-label col-md-3 col-sm-3 col-xs-12">  Vega Firma <span class="required"> * </span></label>
               <div class="col-lg-9 col-md-12 col-sm-12">
               @Html.TextBoxFor(m => m.FirmaID, htmlAttributes: new { @id = "FirmaID", @maxlength = "255", @class = "form-control", @placeholder = "Firma" })
               </div>
        </div>*@
            <div class="form-group m-form__group row">
                <label class="col-form-label col-md-3 col-sm-3 col-xs-12">Vega Firma <span class="required"> * </span></label>
                <div class="col-lg-9 col-md-12 col-sm-12">
                    @Html.DropDownListFor(m => m.FirmaID, new List<SelectListItem>(), new { @id = "FirmaID", @class = "form-control m-select2" })
                </div>
            </div>
            @*<div class="form-group m-form__group row">
            <label class="col-form-label col-md-3 col-sm-3 col-xs-12">Vega Dönem <span class="required"> * </span></label>
            <div class="col-lg-9 col-md-12 col-sm-12">
                @Html.TextBoxFor(m => m.DonemID, htmlAttributes: new { @id = "DonemID", @maxlength = "255", @class = "form-control", @placeholder = "Donem" })
            </div>
        </div>*@
            <div class="form-group m-form__group row">
                <label class="col-form-label col-md-3 col-sm-3 col-xs-12">Vega Dönem <span class="required"> * </span></label>
                <div class="col-lg-9 col-md-12 col-sm-12">
                    @Html.DropDownListFor(m => m.DonemID, new List<SelectListItem>(), new { @id = "DonemID", @class = "form-control m-select2" })
                    @*<select class="form-control m-select2" id="DonemIDD">
                    <option value="0" selected="selected"> Seçiniz</option>
                </select>*@
                </div>
            </div>
            @*<div class="form-group m-form__group row">
            <label class="col-form-label col-md-3 col-sm-3 col-xs-12"> Vega Depo <span class="required"> * </span></label>
            <div class="col-lg-9 col-md-12 col-sm-12">
                @Html.TextBoxFor(m => m.DepoID, htmlAttributes: new { @id = "DepoID", @maxlength = "255", @class = "form-control", @placeholder = "Depo" })
            </div>
        </div>*@
            <div class="form-group m-form__group row">
                <label class="col-form-label col-md-3 col-sm-3 col-xs-12"> Vega Depo <span class="required"> * </span></label>
                <div class="col-lg-9 col-md-12 col-sm-12">
                    @Html.DropDownListFor(m => m.DepoID, new List<SelectListItem>(), new { @id = "DepoID", @class = "form-control m-select2" })
                </div>
            </div>
            @{

                if (Model.VPosSubeKodu != null)
                {
                    <div class="form-group  row vPosShowHide">
                        <label class="col-form-label col-md-3 col-sm-3 col-xs-12">V-Pos Şube</label>
                        <div class="col-lg-9 col-md-12 col-sm-12 ">
                            <button id="btnVPosSubeGetir" type="button" class="btn btn-success">V-Pos Şube Getir</button>
                            @*<select name="VPosSubeKodu" class="form-control m-select2" id="VPosSubeKodu"></select>*@
                            @Html.DropDownListFor(m => m.VPosSubeKodu, new List<SelectListItem>(), new { @id = "VPosSubeKodu", @class = "form-control m-select2" })
                        </div>
                    </div>
                }

            }
            <div class="form-group m-form__group row vPosShowHide">
                <label class="col-form-label col-md-3 col-sm-3 col-xs-12">V-Pos Kasa</label>

                <div class="col-lg-9 col-md-12 col-sm-12 ">
                    <button id="btnVPosKasalariGetir" type="button" class="btn btn-success margin-bottom-10">V-Pos Kasaları Getir</button>
                    @{
                        var k = 0;
                        var kasa = "";
                        if (Model.VPosKasalarList != null)
                        {
                            <label hidden style="padding-left:20px;">Kayıtlı Kasalar: </label>

                            foreach (var item in Model.VPosKasalarList)
                            {
                                if (k == 0)
                                {
                                    kasa += item.ID;
                                }
                                else
                                {
                                    kasa += "," + item.ID;
                                }

                                k++;
                            }
                        }
                        <label hidden id="vposkayitkasa" style="padding-left:20px;">@kasa</label>
                    }

                    @*@Html.DropDownListFor(m => m.VPosKasaKodu, new List<SelectListItem>(), new { @id = "VPosKasaKodu", @class = "form-control m-select2" })*@
                    <select name="VPosKasaKodu" class="form-control m-select2" id="VPosKasaKodu" multiple="multiple" asp-items="ViewBag.VPosKasaKodu"></select>
                </div>
            </div>

            <div class="form-group m-form__group row fasterPosShowHide">
                <label class="col-form-label col-md-3 col-sm-3 col-xs-12"> Faster Kasa </label>
                <div class="col-lg-9 col-md-12 col-sm-12">
                    <div class="m-checkbox-inline">

                        @{ var i = 0;
                            var str = "";
                            if (Model.FR_FasterKasaListesi != null)
                            {
                                <label hidden style="padding-left:20px;">Kayıtlı Kasalar: </label>

                                foreach (var item in Model.FR_FasterKasaListesi)
                                {
                                    if (i == 0)
                                    {
                                        str += item.ID;
                                    }
                                    else
                                    {
                                        str += "," + item.ID;
                                    }

                                    i++;
                                }
                            }
                            <label hidden id="kayitkasa" style="padding-left:20px;">@str</label>
                        }
                    </div>
                    <span style="padding-right: 5px">Hepsini Seç / Temizle </span>
                    <input type="checkbox" id="hepsiniSec">
                    <select name="FasterKasalar" class="form-control m-select2" id="fasterKasalarSelect2" multiple="multiple" asp-items="ViewBag.FasterKasalar"></select>
                    @*@Html.DropDownList("FasterKasalar", "Lütfen seçiniz...")*@
                    @*@Html.DropDownList("FR_FasterKasaListesi", (IEnumerable<SelectListItem>)ViewBag.FasterKasalar, null, new { @id = "fasterKasalarSelect2", @class = "form-control", @multiple = "multiple" })*@
                </div>
            </div>
            <div class="form-group m-form__group row">
                <label class="col-form-label col-md-3 col-sm-3 col-xs-12"> Zimmet Carisi </label>
                <div class="col-lg-9 col-md-12 col-sm-12">
                    @Html.DropDownListFor(m => m.ZimmetCariInd, new List<SelectListItem>(), new { @id = "ZimmetCariInd", @class = "form-control m-select2" })
                </div>
            </div>
                  <div class="form-group m-form__group row">
                <label class="col-form-label col-md-3 col-sm-3 col-xs-12"> Envanter Özel Kod Tipi </label>
                <div class="col-lg-9 col-md-12 col-sm-12">
                    @Html.EnumDropDownListFor(model => model.EnvanterOzelKodTipi, new { @id = "EnvanterOzelKodTipi" })
                </div>
            </div>
            <div class="form-group m-form__group row">
                <label class="col-form-label col-md-3 col-sm-3 col-xs-12"> Envanter Özel Kod  </label>
                <div class="col-lg-9 col-md-12 col-sm-12">
                    @Html.TextBoxFor(m => m.EnvanterOzelKodAdi, htmlAttributes: new { @id = "EnvanterOzelKodAdi", @maxlength = "255", @class = "form-control", @placeholder = "Envanter Özel Kod" })
                </div>
            </div>

            <div class="m-form__group form-group row">
                <label class="col-form-label col-md-3 col-sm-3 col-xs-12"> Belge Sayım Tarih Dahil mi?</label>
                <div class="col-4">
                    <span class="m-switch m-switch--icon m-switch--accent">
                        <label>
                            @Html.CheckBoxFor(m => m.BelgeSayimTarihDahil, htmlAttributes: new { @checked = "checked" })
                            <span></span>
                        </label>
                    </span>
                </div>
            </div>
            <div class="m-form__group form-group row">
                <label class="col-form-label col-md-3 col-sm-3 col-xs-12"> Ürün Eşleştirme Var Mı</label>
                <div class="col-4">
                    <span class="m-switch m-switch--icon m-switch--accent">
                        <label>
                            @Html.CheckBoxFor(m => m.UrunEslestirmeVarMi, htmlAttributes: new { @checked = "checked" })
                            <span></span>
                        </label>
                    </span>
                </div>
            </div>
            <div class="form-group m-form__group row">
                <label class="col-form-label col-md-3 col-sm-3 col-xs-12"> Servis Adresi <span class="required"> * </span></label>
                <div class="col-lg-9 col-md-12 col-sm-12">
                    @Html.TextBoxFor(m => m.ServiceAdress, htmlAttributes: new { @id = "serviceAdress", @maxlength = "255", @class = "form-control", @placeholder = "http://192.168.0.1:8081" })
                </div>
            </div>
            <div class="form-group m-form__group row">
                <label class="col-form-label col-md-3 col-sm-3 col-xs-12"> Servis No <span class="required"> * </span></label>
                <div class="col-lg-9 col-md-12 col-sm-12">
                    @Html.TextBoxFor(m => m.MongoDbServicesId, htmlAttributes: new { @id = "MongoDbServicesId", @maxlength = "255", @class = "form-control", @placeholder = "Servis NO" })
                </div>
            </div>
            <div class="form-group m-form__group row">
                <label class="col-form-label col-md-3 col-sm-3 col-xs-12">Personel Yemek Raporu</label>
                <div class="col-lg-9 col-md-12 col-sm-12">
                    @Html.TextBoxFor(m => m.PersonelYemekRaporu, htmlAttributes: new { @id = "PersonelYemekRaporuId", @maxlength = "255", @class = "form-control", @placeholder = "Personel Yemek Raporu" })
                </div>
            </div>
            <div class="m-form__group form-group row">
                <label class="col-form-label col-md-3 col-sm-3 col-xs-12"> Durumu <span class="required"> * </span> </label>
                <div class="col-4">
                    <span class="m-switch m-switch--icon m-switch--accent">
                        <label>
                            @Html.CheckBoxFor(m => m.Status, htmlAttributes: new { @checked = "checked" })
                            <span></span>
                        </label>
                    </span>
                </div>
            </div>
        </div>
                <div class="m-portlet__foot m-portlet__foot--fit">
                    <div class="m-form__actions m-form__actions">
                        <a href="@Url.Action("List","SubeSettings", new { ut=uygulamaTipi  })" class="btn btn-danger btn-md">
                            Vazgeç
                        </a>
                        <button type="submit" class="btn btn-success"> Kaydet </button>
                    </div>
                </div>
            }
        </fieldset>
        <!--end::Form-->
        <!--end::Portlet-->
    </div>
</div>
@*</div>*@
@*</div>*@

<script>
    $(function () {
        //select2 eklentimizin tanımı
        $('#fasterKasalarSelect2').select2();
        //hepsiniSec kodlarımız
        $("#hepsiniSec").on("click", function () {
            if ($(this).is(':checked')) {
                $("#fasterKasalarSelect2 > option").prop("selected", "selected");
                $("#fasterKasalarSelect2").trigger("change");
            } else {
                $("#fasterKasalarSelect2 > option").removeAttr("selected");
                $("#fasterKasalarSelect2").trigger("change");
            }
        });


        $('#VPosKasaKodu').select2();

    });

         function OnBegin() {
            //mApp.blockPage();
        }

    function OnSuccess(result) {
        var resultObj = JSON.parse(JSON.stringify(result));
        if (resultObj.IsSuccess == true) {
            SuccessAlert(resultObj.UserMessage);

            setTimeout(function () { parent.location = "@Url.Action("List", Controller,new {ut=ViewBag.UygulamaTipi })"; }, 1000);
        } else {
            DangerAlert(resultObj.UserMessage);
        }
    }

    function OnComplete() {
        window.setTimeout(function () {
        //    mApp.unblockPage();
        }, 100);
    }

    jQuery(document).ready(function () {

       @*VPos*@
            $(document).on("click", "#btnVPosSubeGetir", function (e) {
            debugger;
            var AppDbType = $("#AppDbTypeid").val();
            var SubeIP = $('#SabsatationIp').val();
            var SqlName = $("#SqlName").val();
            var DBName = $('#DBName').val();
            var SqlPassword = $('#SqlPassword').val();

            if (!AppDbType || !SubeIP || !SqlName || !DBName || !SqlPassword) {
                return alert('Lütfen Şube IP, Sql Adı, Db Adı, Sql Şifresi alanlarını giriniz.')
            }
                VPosSubeList(AppDbType, SubeIP, SqlName, DBName, SqlPassword);
        });

    function VPosSubeList(AppDbType,  SubeIP, SqlName, DBName, SqlPassword) {
        $.ajax({
            url: '/SubeSettings/VPosSubeListJson?AppDbType=' + AppDbType + '&SubeIP=' + SubeIP + '&SqlName=' + SqlName + '&DBName=' + DBName + '&SqlPassword=' + SqlPassword  + '',
            type: 'POST',
            beforeSend: function (request) {
                //mApp.blockPage();
            },
            complete: function () {
                window.setTimeout(function () {
                    //mApp.unblockPage();
                }, 100);
            },
            dataType: 'json',
            success: function (data) {
                var options = $('#VPosSubeKodu');
                $('option', options).remove();
                options.append($('<option />').val(0).text("Seçiniz"));
                $.each(data, function () {
                    options.append($('<option />').val(this.Value).text(this.Text));
                });

                if ("@Model.VPosSubeKodu"||0 > 0) {
                    $('#VPosSubeKodu').val('@Model.VPosSubeKodu').trigger('change');
                } else { $('#VPosSubeKodu').val('0').trigger('change'); }
            }
        });
       }
        VPosSubeList($("#AppDbTypeid").val(), $('#SabsatationIp').val(), $("#SqlName").val(), $('#DBName').val(), $('#SqlPassword').val());
        @* VPos *@

        //$('#FasterKasaID').selectpicker();
    var TipId = 0;
       function FirmaList() {
        $.ajax({
            url: '/SubeSettings/FirmaListtJson',
            type: 'POST',
            beforeSend: function (request) {
                //mApp.blockPage();
            },
            complete: function () {
                window.setTimeout(function () {
                    //mApp.unblockPage();
                }, 100);
            },
            dataType: 'json',
            success: function (data) {
                var options = $('#FirmaID');
                $('option', options).remove();
                options.append($('<option />').val(0).text("Seçiniz"));
                $.each(data, function () {
                    options.append($('<option />').val(this.Value).text(this.Text));
                });

                if ("@Model.FirmaID"||0 > 0) {
                    $('#FirmaID').val('@Model.FirmaID').trigger('change');
                } else { $('#FirmaID').val('0').trigger('change'); }
            }
        });
    }
    FirmaList();

    //bolgeye göre il list
        $(document).on("change", "#FirmaID", function (e) {
            var TanimId = $(this).val();
            if (TanimId == 0 && TanimId == "") { return false; }
            //$('#subeID').val('0').trigger('change');

            var data = { TanimId: TanimId };
            $.ajax({
                url: '/SubeSettings/DonemListJson',
                type: 'POST',
                beforeSend: function (request) {
                    //mApp.blockPage();
                },
                complete: function () {
                    window.setTimeout(function () {
                        //mApp.unblockPage();
                    }, 100);
                },
                dataType: 'json',
                data: data,
                success: function (data) {
                    var options = $('#DonemID');
                    $('option', options).remove();
                    options.append($('<option />').val(0).text("Seçiniz"));
                    $.each(data, function () {
                        options.append($('<option />').val(this.Value).text(this.Text));
                    });

                    if ("@Model.DonemID"||0 > 0) {
                        $('#DonemID').val('@Model.DonemID').trigger('change');
                    } else { $('#DonemID').val('0').trigger('change'); }
                }
            });

            //
             var data = { TanimId: TanimId };
            $.ajax({
                url: '/SubeSettings/ZimmetCariListJson',
                type: 'POST',
                beforeSend: function (request) {
                    //mApp.blockPage();
                },
                complete: function () {
                    window.setTimeout(function () {
                        //mApp.unblockPage();
                    }, 100);
                },
                dataType: 'json',
                data: data,
                success: function (data) {
                    var options = $('#ZimmetCariInd');
                    $('option', options).remove();
                    options.append($('<option />').val(0).text("Seçiniz"));
                    $.each(data, function () {
                        options.append($('<option />').val(this.Value).text(this.Text));
                    });

                    if ("@Model.ZimmetCariInd"||0 > 0) {
                        $('#ZimmetCariInd').val('@Model.ZimmetCariInd').trigger('change');
                    } else { $('#ZimmetCariInd').val('0').trigger('change'); }
                }
            });
            //

            $.ajax({
                url: '/SubeSettings/DepoListJson',
                type: 'POST',
                beforeSend: function (request) {
                    //mApp.blockPage();
                },
                complete: function () {
                    window.setTimeout(function () {
                        //mApp.unblockPage();
                    }, 100);
                },
                dataType: 'json',
                data: data,
                success: function (data) {
                    var options = $('#DepoID');
                    $('option', options).remove();
                    options.append($('<option />').val(0).text("Seçiniz"));
                    $.each(data, function () {
                        options.append($('<option />').val(this.Value).text(this.Text));
                    });

                    if ("@Model.DepoID"||0 > 0) {
                        $('#DepoID').val('@Model.DepoID').trigger('change');
                    } else { $('#DepoID').val('0').trigger('change'); }
                }
            });

             $.ajax({
                 url: '/SubeSettings/FasterKasaListtJson',
                type: 'POST',
                beforeSend: function (request) {
                    //mApp.blockPage();
                },
                complete: function () {
                    window.setTimeout(function () {
                        //mApp.unblockPage();
                    }, 100);
                },
                dataType: 'json',
                data: data,
                 success: function (data) {

                     var options = $('#fasterKasalarSelect2');
                     $('option', options).remove();
                     //options.append($('<option />').val(0).text("Seçiniz"));
                     var lst = $('#kayitkasa')[0].innerHTML.split(',')
                     $.each(data, function () {
                         var val = this.Value;
                         if (lst && lst.length > 0 && val) {
                             var snc = lst.filter(function (dt) { return dt == val });
                             console.log(snc)
                             if (snc.length > 0) {
                                 options.append($('<option selected/>').val(this.Value).text(this.Text));
                             } else {
                                 options.append($('<option />').val(this.Value).text(this.Text));
                             }
                         } else {
                             options.append($('<option />').val(this.Value).text(this.Text));
                         }

                     });
                     //if ('#fasterKasalarSelect2' > 0) {
                     //    $('#fasterKasalarSelect2').val('#fasterKasalarSelect2').trigger('change');
                     //} else { $('#fasterKasalarSelect2').val('0').trigger('change'); }
                }
            });


            @* VPos *@
            $(document).on("click", "#btnVPosKasalariGetir", function (e) {
                debugger;
                var AppDbType = $("#AppDbTypeid").val();
                var SubeIP = $('#SabsatationIp').val();
                var SqlName = $("#SqlName").val();
                var DBName = $('#DBName').val();
                var SqlPassword = $('#SqlPassword').val();
                var SubeKodu = $('#VPosSubeKodu').val();
                var Id = $('#ID').val();

                var selectedText = "";
                var t = document.getElementById("VPosSubeKodu");
                selectedText = t.options[t.selectedIndex].Value;

                if (!AppDbType || !SubeIP || !SqlName || !DBName || !SqlPassword || !SubeKodu ) {
                    return alert('Lütfen Şube IP, Sql Adı, Db Adı, Sql Şifresi alanlarını giriniz.')
                }

                VPosKasaList(AppDbType, SubeIP, SqlName, DBName, SqlPassword, SubeKodu,Id);
        });

            function VPosKasaList(AppDbType, SubeIP, SqlName, DBName, SqlPassword, SubeKodu,Id) {
                $.ajax({
                    url: '/SubeSettings/VPosKasaListJson?AppDbType=' + AppDbType + '&SubeIP=' + SubeIP + '&SqlName=' + SqlName + '&DBName=' + DBName + '&SqlPassword=' + SqlPassword + '&SubeKodu=' + SubeKodu + + '&Id=' + Id +'',
                    type: 'POST',
                    beforeSend: function (request) {
                        //mApp.blockPage();
                    },
                    complete: function () {
                        window.setTimeout(function () {
                            //mApp.unblockPage();
                        }, 100);
                    },
                    dataType: 'json',
                    data: data,
                    success: function (data) {

                        var options = $('#VPosKasaKodu');
                        $('option', options).remove();
                        //options.append($('<option />').val(0).text("Seçiniz"));
                        var lst = $('#vposkayitkasa')[0].innerHTML.split(',')
                        $.each(data, function () {
                            var val = this.Value;
                            if (lst && lst.length > 0 && val) {
                                var snc = lst.filter(function (dt) { return dt == val });
                                console.log(snc)
                                if (snc.length > 0) {
                                    options.append($('<option selected/>').val(this.Value).text(this.Text));
                                } else {
                                    options.append($('<option />').val(this.Value).text(this.Text));
                                }
                            } else {
                                options.append($('<option />').val(this.Value).text(this.Text));
                            }
                        });
                    }
                });
            }
            VPosKasaList($("#AppDbTypeid").val(), $('#SabsatationIp').val(), $("#SqlName").val(), $('#DBName').val(), $('#SqlPassword').val(), $('#VPosSubeKodu').val(), $('#ID').val());
            @* VPos *@


            $("#AppDbTypeid").on("change", function () {
                debugger;
                var AppDbType = $("#AppDbTypeid").val();
                if (AppDbType==5) {
                    $('.vPosShowHide').show('fast');
                } else {
                    $('.vPosShowHide').hide('fast');
                }

                if (AppDbType == 3) {
                    $('.fasterPosShowHide').show('fast');
                } else {
                    $('.fasterPosShowHide').hide('fast');
                }
            });
            var AppDbType = $("#AppDbTypeid").val();
            if (AppDbType == 5) {
                $('.vPosShowHide').show('fast');
            } else {
                $('.vPosShowHide').hide('fast');
            }
            if (AppDbType == 3) {
                $('.fasterPosShowHide').show('fast');
            } else {
                $('.fasterPosShowHide').hide('fast');
            }
            @* VPos *@


            //$.ajax({
            //    url: '/SubeSettings/FasterKasaListtJson',
            //    type: 'POST',
            //    data: data,
            //    beforeSend: function (request) {
            //        //mApp.blockPage();
            //    },
            //    complete: function () {
            //        window.setTimeout(function () {
            //            //mApp.unblockPage();
            //        }, 100);
            //    },
            //    dataType: 'json',
            //    success: function (data) {
            //        debugger;
            //        $("input:checkbox[name=Auth]").prop("checked", false);
            //        if (data.FasterKasaListesi != null) {
            //            var array = data.FasterKasaListesi.substring(0, data.FasterKasaListesi.length - 1).split(',');
            //            $.each(array, function (key, value) {
            //                $("#auth_" + value).prop("checked", true);
            //            });
            //        }
            //    }
            //});

        });
        //




    //function DonemList() {
    //    $.ajax({
    //        url: '/SubeSettings/DonemListJson',
    //        type: 'POST',
    //        beforeSend: function (request) {
    //            //mApp.blockPage();
    //        },
    //        complete: function () {
    //            window.setTimeout(function () {
    //                //mApp.unblockPage();
    //            }, 100);
    //        },
    //        dataType: 'json',
    //        success: function (data) {
    //            var options = $('#DonemID');
    //            $('option', options).remove();
    //            options.append($('<option />').val(0).text("Seçiniz"));
    //            $.each(data, function () {
    //                options.append($('<option />').val(this.Value).text(this.Text));
    //            });

                @*if (@Model.DonemID > 0) {
                    $('#DonemID').val('@Model.DonemID').trigger('change');
                } else { $('#DonemID').val('0').trigger('change'); }

                 @*if(@Model.IL_ID > 0){
                        $('#SubelerIli').val('@Model.IL_ID').trigger('change');
                    }*@
    //        }
    //    });
    //}
    //DonemList();

    @*function DepoList() {
        $.ajax({
            url: '/SubeSettings/DepoListJson',
            type: 'POST',
            beforeSend: function (request) {
                //mApp.blockPage();
            },
            complete: function () {
                window.setTimeout(function () {
                    //mApp.unblockPage();
                }, 100);
            },
            dataType: 'json',
            success: function (data) {
                var options = $('#DepoID');
                $('option', options).remove();
                options.append($('<option />').val(0).text("Seçiniz"));
                $.each(data, function () {
                    options.append($('<option />').val(this.Value).text(this.Text));
                });
                @{

                 }
                if (@Model.DepoID > 0) {
                    $('#DepoID').val('@Model.DepoID').trigger('change');
                } else { $('#DepoID').val('0').trigger('change'); }
            }
        });
    }
        DepoList();*@

    });
</script>
