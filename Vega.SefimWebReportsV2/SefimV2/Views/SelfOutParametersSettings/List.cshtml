@model List<SefimV2.ViewModels.SelfOutParametersSettings.SelfOutParametersSettingsViewModel>

@{
    #region base URL bilgisi set ediliyor
    var urlHelper = new UrlHelper(Html.ViewContext.RequestContext);
    string baseUrl = urlHelper.Content("~");
    #endregion
    var uygulamaTipi = ViewBag.UygulamaTipi;
    if (uygulamaTipi == "sp")
    {
    Layout = "~/Views/Shared/_LayoutPageSPos.cshtml";
    }
    else
    {
        Layout = "~/Views/Shared/_LayoutPage.cshtml";
    }
}

<script src="@(baseUrl)Content/ajax/alerts.js" type="text/javascript"></script>
<link href="/Assets/css/bootstrap.css" rel="stylesheet" />
<link href="/Assets/css/custom.css" rel="stylesheet" />
<link href="/Assets/plugins/fUpload/Uploader-style.css" rel="stylesheet" />
<link href="~/Content/ContentSefPanel/css/costomfieldset/customfielset.css" rel="stylesheet" />

<div class="m-content">
    <div class="row">
        <div class="col-lg-12">
            <div id="notification"></div>
        </div>
    </div>
</div>

<fieldset class="well the-fieldset coolfieldset">
    <legend class="the-legend">@ViewBag.PageTitle @ViewBag.ActionTitle </legend>
    @using (Ajax.BeginForm("Update", "SelfOutParametersSettings", FormMethod.Post, new AjaxOptions { OnSuccess = "OnSuccess", OnBegin = "OnBegin", OnComplete = "OnComplete" }, htmlAttributes: new { @class = "m-form", @id = "selfOutParametersSettings" }))
    {
        @Html.AntiForgeryToken()
        @Html.ValidationSummary()
        <div class="table-responsive">
            <div class="table-container">
                <div style="float:left; padding-top:1px;">
                    <input type="submit" value="Kaydet" class="btn btn-lg btn-success" />
                </div>
                <div class="x_content">
                    <p class="text-muted font-13 m-b-30">
                    </p>
                    <table id="tableRapor" class="table table-striped table-bordered">
                        <thead>
                            <tr style="background: #fffaf0">
                                <th>İşlem Adı</th>
                                <th>Self Sync</th>
                            </tr>
                        </thead>
                        <tbody>
                            @{
                                for (int i = 0; i < Model.Count; i++)
                                {
                                    <tr>
                                        <td>
                                            @Html.HiddenFor(m => Model[i].Id)
                                            @Model[i].TableName
                                        </td>
                                        <td>   @Html.CheckBoxFor(m => Model[i].IsSelfSync, htmlAttributes: new { @checked = "checked" }) </td>
                                    </tr>
                                }
                            }
                        </tbody>
                    </table>
                </div>
                <div style="float:left; padding-top:1px;">
                    <input type="submit" value="Kaydet" class="btn btn-lg btn-success" />
                </div>
            </div>
        </div>
    }
</fieldset>

<script>
        function OnBegin() {
            //mApp.blockPage();
        }
    function OnSuccess(result) {
        var resultObj = JSON.parse(JSON.stringify(result));

        if (resultObj.IsSuccess == true) {
            SuccessAlert(resultObj.UserMessage);
            setTimeout(function () { parent.location = "@Url.Action("List", "SelfOutParametersSettings", new { ut = ViewBag.UygulamaTipi })"; }, 1000);
        } else {
            DangerAlert(resultObj.UserMessage);
        }
    }

    function OnComplete() {
        window.setTimeout(function () {
        //    mApp.unblockPage();
        }, 100);
    }
</script>
