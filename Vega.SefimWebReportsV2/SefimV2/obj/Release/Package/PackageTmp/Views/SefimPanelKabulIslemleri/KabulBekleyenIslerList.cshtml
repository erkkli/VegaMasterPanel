@model IEnumerable<SefimV2.ViewModels.SPosKabulIslemleri.BelgeDepoKabul>

@{
    Layout = "~/Views/Shared/_LayoutPageSPos.cshtml";
}

<div class="m-content">
    <div class="row">
        <div class="col-lg-12">
            <div id="notification"></div>
        </div>
    </div>
    <div class="m-subheader ">
        <div class="d-flex align-items-center">
            @*<div class="mr-auto">
                    <h2 class="m-subheader__title m-subheader__title--separator" style="text-align:center;margin-top:1px;margin-bottom:1px">Kabul Bekleyenler Listesi</h2>
                </div>*@
        </div>
    </div>
    <div class="col-lg-12">
        <div class="table-responsive">
            <div class="table-container">
                <div class="x_content">
                    <table id="tableRapor" class="table table-hover table-condensed  table-bordered">
                        <thead>
                            <tr style="background: #fffaf0">
                                <th>İşlemler</th>
                                <th>Gönderen Depo Kodu</th>
                                <th>Kabul Edecek Depo Kodu</th>
                                <th>Tarih</th>
                                <th>Fiş No</th>
                                <th>Özel Kod 3</th>
                                <th>Özel Kod 4</th>
                            </tr>
                        </thead>
                        <tbody>
                            @{
                                foreach (var item in Model)
                                {
                                    <tr id="@item.BelgeID">
                                        <td>
                                            @if(@item.BelgeID>0){
                                            <a class="btn btn-success" onclick="lib.onayla(@item.BelgeID)" title="Onayla">
                                                Onayla
                                            </a>

                                            <a class="btn btn-danger" onclick="lib.ret(@item.BelgeID)" title="Ret">
                                                Ret
                                            </a>
                                            }
                                            <a class="btn btn-warning" href="/SefimPanelBelgeIslemleri/AlisBelgesiCreate?ID=@item.BelgeID&BelgeNo=@item.FISNO&Page=/SefimPanelKabulIslemleri/KabulBekleyenIslerList" title="Şubedeki ürün bilgilerini güncelle">
                                                Düzenle
                                            </a>
                                        </td>
                                        <td> @item.GONDERENDEPOKODU  </td>
                                        <td> @item.KABULEDECEKDEPOKODU  </td>
                                        <td> @item.TARIH  </td>
                                        <td> @item.FISNO  </td>
                                        <td> @item.OZELKOD3  </td>
                                        <td> @item.OZELKOD4  </td>
                                    </tr>
                                }
                            }
                        </tbody>
                    </table>
                </div>

            </div>
        </div>
    </div>
</div>


<script type="text/javascript">

    var lib = {};
    lib.ret = function (Id) {
        if (confirm("Belgeyi ret etmek istiyor musunuz?")) {
            $.ajax({
                url: '/SefimPanelBelgeIslemleri/AlisBelgesiRet',
                type: 'POST',
                data: { BelgeId: Id },
                beforeSend: function (request) {
                    //mApp.blockPage();
                },
                complete: function () {
                    window.setTimeout(function () {
                        //mApp.unblockPage();
                    }, 100);
                },
                dataType: 'json',
                success: function (data) {
                    $("#" + Id).remove();
                },
                error: function (err) {
                    alert(error.UserMessage)
                }
            });

        } else {

        }

    }
    lib.onayla = function (Id) {
        if (confirm("Belgeyi onaylamak istiyor musunuz?")) {
            $.ajax({
                url: '/SefimPanelBelgeIslemleri/AlisBelgesiOnay',
                type: 'POST',
                data: { BelgeId: Id },
                beforeSend: function (request) {
                    //mApp.blockPage();
                },
                complete: function () {
                    window.setTimeout(function () {
                        //mApp.unblockPage();
                    }, 100);
                },
                dataType: 'json',
                success: function (data) {
                    if (data.IsSuccess) {
                        alert("Onaylama başarılı.");
                        $("#" + Id).remove();
                    }
                    else {
                        alert("Bilgi eklenemedi." + data.UserMessage);
                    }

                },
                error: function (err) {
                    alert(error.UserMessage)
                }
            });
        } else {

        }
    }
    $('tr').dblclick(function () {
        return false; // does both event.stopPropogation as well as event.preventDefault
    });

</script>


