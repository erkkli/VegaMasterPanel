
declare @Sube nvarchar(100) = '{SUBE}';
declare @Trh1 nvarchar(20) = '{TARIH1}';
declare @Trh2 nvarchar(20) = '{TARIH2}';

     SELECT @Sube AS Sube,

   (SELECT TOP 1 SUBEADI
      FROM TBLFASTERKASALAR
      WHERE SUBENO=FO.SUBEIND) AS Sube1,

     (SELECT KASAADI
      FROM TBLFASTERKASALAR
      WHERE KASANO=FO.KASAIND) AS Kasa,

	    (SELECT IND
      FROM TBLFASTERKASALAR
      WHERE KASANO=FO.KASAIND) AS ID,

	 SUM(ISNULL(ODENEN,0)) Tutar

   FROM DBO.TBLFASTERODEMELER FO
   LEFT JOIN DBO.TBLFASTERUSERS USR ON FO.USERIND=USR.USERNO
   WHERE ISNULL(FO.IADE, 0) = 1
     AND ODEMETIPI IN (0,
                       1,
                       2,
                       4)
     AND ISLEMTARIHI >= @Trh1
     AND ISLEMTARIHI <= @Trh2
  
  GROUP BY 
  FO.SUBEIND,FO.KASAIND
